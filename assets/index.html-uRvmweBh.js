import{_ as r,r as i,o,c as l,b as e,e as t,d as n,a as s}from"./app-D_mlLpjO.js";const d={},c=e("h1",{id:"development",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#development"},[e("span",null,"Development")])],-1),p=e("p",null,"This page may include outdated information.",-1),h=e("h2",{id:"architecture",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#architecture"},[e("span",null,"Architecture")])],-1),u=e("p",null,"The OpenUPM service is composed of below sub-systems:",-1),g=e("li",null,"Public upm registry",-1),b=e("li",null,"*Automatic build pipelines",-1),m=e("li",null,"*Website next",-1),_=e("li",null,"*Website backend (API)",-1),f=e("li",null,"*Package curated list",-1),v={href:"https://github.com/openupm/openupm-cli",target:"_blank",rel:"noopener noreferrer"},y=e("code",null,"*",-1),k={href:"https://github.com/openupm/openupm",target:"_blank",rel:"noopener noreferrer"},x=s(`<h2 id="directory-structure" tabindex="-1"><a class="header-anchor" href="#directory-structure"><span>Directory Structure</span></a></h2><div class="language-text" data-ext="text" data-title="text"><pre class="language-text"><code>.
├── src          # backend
│   ├── node       # node.js server
│   ├── shared     # shared code between node and client
├── data         # linked data folder
├── docs         # website frontend (vuepress)
└── test        # unit tests
</code></pre></div><h2 id="public-upm-registry" tabindex="-1"><a class="header-anchor" href="#public-upm-registry"><span>Public UPM Registry</span></a></h2><p>OpenUPM uses a custom verdaccio to host the registry. Though verdaccio is the most popular open-source project to set up a private npm registry, most deployments served a very limited user base or for the testing purpose that doesn&#39;t care about performance much. OpenUPM try to solve quite a few issues related to the cluster deployment. Before these PRs get merged, OpenUPM will stay with the custom build:</p>`,4),P={href:"https://github.com/verdaccio/monorepo/issues/250",target:"_blank",rel:"noopener noreferrer"},w={href:"https://github.com/verdaccio/verdaccio/issues/1595",target:"_blank",rel:"noopener noreferrer"},A={href:"https://github.com/verdaccio/verdaccio/issues/1459",target:"_blank",rel:"noopener noreferrer"},U=e("code",null,"npm publish -f",-1),j=e("code",null,"npm unpublish",-1),M={href:"https://github.com/verdaccio/verdaccio/issues/1435",target:"_blank",rel:"noopener noreferrer"},O={href:"https://github.com/verdaccio/verdaccio/issues/1597",target:"_blank",rel:"noopener noreferrer"},C=e("p",null,"Since OpenUPM has it's own way to organize the package list, the verdaccio website and API endpoints are disabled (headless mode).",-1),D=e("h2",{id:"automatic-build-pipelines",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#automatic-build-pipelines"},[e("span",null,"Automatic Build Pipelines")])],-1),N={href:"https://azure.microsoft.com/en-us/services/devops/pipelines/",target:"_blank",rel:"noopener noreferrer"},E=s('<h3 id="cronjob" tabindex="-1"><a class="header-anchor" href="#cronjob"><span>Cronjob</span></a></h3><p>OpenUPM uses pm2 cron feature to run cronjobs.</p><table><thead><tr><th>Job</th><th>Description</th><th style="text-align:right;">GitHub Reset API</th><th style="text-align:right;">GitHub GraphQL API</th></tr></thead><tbody><tr><td>add-build-package-job</td><td>add build-pkg to the job queue.</td><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td>fetch-package-extra</td><td>fetch package README, stars, ogimage</td><td style="text-align:right;">n</td><td style="text-align:right;">2n</td></tr><tr><td>aggregate-package-extra</td><td>aggregate package extra</td><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td>update-recent-packages</td><td>update recent updated packages</td><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td>fetch-site-info</td><td>fetch repo stars</td><td style="text-align:right;">1</td><td style="text-align:right;"></td></tr><tr><td>update-feeds</td><td>update RSS feeds</td><td style="text-align:right;"></td><td style="text-align:right;"></td></tr></tbody></table><h3 id="job-queue" tabindex="-1"><a class="header-anchor" href="#job-queue"><span>Job Queue</span></a></h3>',4),T={href:"https://github.com/bee-queue/bee-queue",target:"_blank",rel:"noopener noreferrer"},L=s('<table><thead><tr><th>Job</th><th>Description</th><th style="text-align:right;">GitHub API</th></tr></thead><tbody><tr><td><code>build-pkg:&lt;pkg&gt;</code></td><td>fetch repo info and create build-rel jobs for valid Git tags</td><td style="text-align:right;">0</td></tr><tr><td><code>build-rel:&lt;pkg&gt;:&lt;ver&gt;</code></td><td>build pkg@version via Azure Pipelines</td><td style="text-align:right;">0</td></tr></tbody></table><h3 id="github-rate-limit" tabindex="-1"><a class="header-anchor" href="#github-rate-limit"><span>GitHub Rate Limit</span></a></h3>',2),S={href:"https://docs.github.com/en/free-pro-team@latest/rest/reference/rate-limit",target:"_blank",rel:"noopener noreferrer"},I=e("div",{class:"language-text","data-ext":"text","data-title":"text"},[e("pre",{class:"language-text"},[e("code",null,`yarn gh:ratelimit
`)])],-1),R=e("h2",{id:"website-frontend",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#website-frontend"},[e("span",null,"Website Frontend")])],-1),B={href:"https://vuepress.vuejs.org",target:"_blank",rel:"noopener noreferrer"},q=s(`<div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">source</span> env.sh
<span class="token function">yarn</span> docs:dev
</code></pre></div><p>To enable webpack bundle analyzer:</p><div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token assign-left variable">WEBPACK_BUNDLE_ANALYZER</span><span class="token operator">=</span><span class="token number">1</span> <span class="token function">yarn</span> docs:build
</code></pre></div><h2 id="website-backend" tabindex="-1"><a class="header-anchor" href="#website-backend"><span>Website Backend</span></a></h2>`,4),W={href:"http://expressjs.com/",target:"_blank",rel:"noopener noreferrer"},z=s(`<div class="language-bash" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">yarn</span> server:dev
</code></pre></div><h2 id="package-curated-list" tabindex="-1"><a class="header-anchor" href="#package-curated-list"><span>Package Curated List</span></a></h2><p>OpenUPM uses git as a database to maintain the package curated list. Each package is described as a YAML file.</p><h2 id="i18n" tabindex="-1"><a class="header-anchor" href="#i18n"><span>i18n</span></a></h2><p>The website supports two regions with different configurations:</p><table><thead><tr><th>Region</th><th>Language</th><th>Fallback Language</th></tr></thead><tbody><tr><td>US</td><td>en-US</td><td>n/a</td></tr><tr><td>CN</td><td>zh-CN</td><td>en-US</td></tr></tbody></table>`,6),G=e("li",null,[e("p",null,[t("The documentation level translations are located at "),e("code",null,"docs/zh"),t(".")])],-1),V=e("code",null,"docs/.vuepress/locales",-1),H={href:"https://github.com/antfu/i18n-ally",target:"_blank",rel:"noopener noreferrer"},J=e("li",null,[e("p",null,"To develop the CN region:"),e("div",{class:"language-text","data-ext":"text","data-title":"text"},[e("pre",{class:"language-text"},[e("code",null,`VITE_OPENUPM_REGION=cn npm run docs:dev
`)])])],-1);function Q(F,Y){const a=i("ExternalLinkIcon");return o(),l("div",null,[c,p,h,u,e("ul",null,[g,b,m,_,f,e("li",null,[e("a",v,[t("OpenUPM-CLI"),n(a)]),t(" command-line tool")])]),e("p",null,[t("Entries with "),y,t(" prefix are located in the "),e("a",k,[t("main repository"),n(a)]),t(".")]),x,e("ul",null,[e("li",null,[t("S3 storage with CDN "),e("a",P,[t("#250"),n(a)])]),e("li",null,[t("Stateless s3 storage for cluster deployment "),e("a",w,[t("#1595"),n(a)]),t(", "),e("a",A,[t("#1459"),n(a)])]),e("li",null,[t("Commands "),U,t(" and "),j,t(" return 404 "),e("s",null,[e("a",M,[t("#1435"),n(a)])])]),e("li",null,[t("Wrong timestamp for old search API "),e("s",null,[e("a",O,[t("#1597"),n(a)])])])]),C,D,e("p",null,[t("OpenUPM watches the package curated list regularly detects new contents and uses the job queue to build packages through "),e("a",N,[t("Azure Pipelines"),n(a)]),t(".")]),E,e("p",null,[t("OpenUPM uses "),e("a",T,[t("Bee-Queue"),n(a)]),t(" to manage the job queue.")]),L,e("p",null,[t("Print the "),e("a",S,[t("rate limit"),n(a)]),t(" status.")]),I,R,e("p",null,[t("OpenUPM uses "),e("a",B,[t("VuePress"),n(a)]),t(" - a static website generator to develop website next.")]),q,e("p",null,[t("OpenUPM uses "),e("a",W,[t("Express"),n(a)]),t(" to develop website backend (API).")]),z,e("ul",null,[G,e("li",null,[e("p",null,[t("The component level translations are located at "),V,t(". "),e("a",H,[t("i18n-ally"),n(a)]),t(" is powerful i18n extensions for VS Code to edit locale files.")])]),J])])}const Z=r(d,[["render",Q],["__file","index.html.vue"]]),X=JSON.parse('{"path":"/docs/dev/","title":"Development","lang":"zh-CN","frontmatter":{"description":"Development This page may include outdated information. Architecture The OpenUPM service is composed of below sub-systems: Public upm registry *Automatic build pipelines *Websit...","head":[["link",{"rel":"canonical","href":"https://openupm.cn/docs/dev/"}],["meta",{"property":"og:url","content":"https://openupm.cn/docs/dev/"}],["meta",{"property":"og:site_name","content":"OpenUPM中文网"}],["meta",{"property":"og:title","content":"Development"}],["meta",{"property":"og:description","content":"Development This page may include outdated information. Architecture The OpenUPM service is composed of below sub-systems: Public upm registry *Automatic build pipelines *Websit..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://openupm.cn/images/openupm-twitter.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"Development"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Development\\",\\"image\\":[\\"https://openupm.cn/images/openupm-twitter.png\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[{"level":2,"title":"Architecture","slug":"architecture","link":"#architecture","children":[]},{"level":2,"title":"Directory Structure","slug":"directory-structure","link":"#directory-structure","children":[]},{"level":2,"title":"Public UPM Registry","slug":"public-upm-registry","link":"#public-upm-registry","children":[]},{"level":2,"title":"Automatic Build Pipelines","slug":"automatic-build-pipelines","link":"#automatic-build-pipelines","children":[{"level":3,"title":"Cronjob","slug":"cronjob","link":"#cronjob","children":[]},{"level":3,"title":"Job Queue","slug":"job-queue","link":"#job-queue","children":[]},{"level":3,"title":"GitHub Rate Limit","slug":"github-rate-limit","link":"#github-rate-limit","children":[]}]},{"level":2,"title":"Website Frontend","slug":"website-frontend","link":"#website-frontend","children":[]},{"level":2,"title":"Website Backend","slug":"website-backend","link":"#website-backend","children":[]},{"level":2,"title":"Package Curated List","slug":"package-curated-list","link":"#package-curated-list","children":[]},{"level":2,"title":"i18n","slug":"i18n","link":"#i18n","children":[]}],"filePathRelative":"docs/dev/index.md","autoDesc":true}');export{Z as comp,X as data};
